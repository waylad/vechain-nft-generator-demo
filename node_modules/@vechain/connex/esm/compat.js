import { abi } from 'thor-devkit';
import * as R from '@vechain/connex-framework/dist/rules';
/** ports connex v1 to connex v2 */
export function compat1(connex1) {
    const t1 = connex1.thor;
    const v1 = connex1.vendor;
    return {
        get thor() {
            const t2 = {
                get genesis() { return t1.genesis; },
                get status() {
                    const s = t1.status;
                    return Object.assign(Object.assign({}, s), { head: Object.assign(Object.assign({}, s.head), { gasLimit: 20000000 }) });
                },
                ticker: () => {
                    const t = t1.ticker();
                    return {
                        next: () => t.next().then(h => (Object.assign(Object.assign({}, h), { gasLimit: 20000000 })))
                    };
                },
                account: addr => {
                    const a1 = t1.account(addr);
                    return {
                        get address() { return a1.address; },
                        get: () => a1.get(),
                        getCode: () => a1.getCode(),
                        getStorage: key => a1.getStorage(key),
                        method: jsonABI => newMethod(a1, jsonABI, this),
                        event: jsonABI => newEvent(a1, jsonABI, this)
                    };
                },
                block: rev => t1.block(rev),
                transaction: id => t1.transaction(id),
                filter: (kind, criteria) => {
                    const f1 = t1.filter(kind);
                    f1.criteria(criteria);
                    return {
                        range(r) { f1.range(r); return this; },
                        order(o) { f1.order(o); return this; },
                        cache() { console.warn('filter :cache is not supported in compat mode'); return this; },
                        apply(offset, limit) {
                            return f1.apply(offset, limit);
                        }
                    };
                },
                explain: (clauses) => {
                    const e1 = t1.explain();
                    return {
                        caller(addr) { e1.caller(addr); return this; },
                        gas(gas) { e1.gas(gas); return this; },
                        gasPrice(gp) { e1.gasPrice(gp); return this; },
                        gasPayer(addr) { console.warn("gasPayer is not supported in compat mode"); return this; },
                        cache() { console.warn('explainer :cache is not supported in compat mode'); return this; },
                        execute: () => e1.execute(clauses)
                    };
                }
            };
            return t2;
        },
        get vendor() {
            return {
                sign: (kind, msg) => {
                    let onAccepted;
                    if (kind === 'tx') {
                        const s1 = v1.sign(kind);
                        const s2 = {
                            signer(addr) { s1.signer(addr); return this; },
                            gas(gas) { s1.gas(gas); return this; },
                            dependsOn(txid) { s1.dependsOn(txid); return this; },
                            link(url) { s1.link(url); return this; },
                            comment(text) { s1.comment(text); return this; },
                            delegate( /*url, signer */) {
                                console.warn('delegate is not supported in compat mode');
                                return this;
                            },
                            accepted(cb) { onAccepted = cb; return this; },
                            request: () => {
                                onAccepted && onAccepted();
                                return s1.request(msg);
                            }
                        };
                        return s2;
                    }
                    else {
                        const s1 = v1.sign(kind);
                        const s2 = {
                            signer(addr) { s1.signer(addr); return this; },
                            link(url) { s1.link(url); return this; },
                            accepted(cb) {
                                onAccepted = cb;
                                return this;
                            },
                            request: () => {
                                onAccepted && onAccepted();
                                return s1.request(msg);
                            }
                        };
                        return s2;
                    }
                }
            };
        }
    };
}
const newMethod = (acc, jsonABI, connex) => {
    const coder = new abi.Function(JSON.parse(JSON.stringify(jsonABI)));
    let value = 0;
    const opts = {};
    return {
        value(val) {
            value = R.test(val, R.bigInt, 'arg0');
            return this;
        },
        caller(addr) {
            opts.caller = R.test(addr, R.address, 'arg0').toLowerCase();
            return this;
        },
        gas(gas) {
            opts.gas = R.test(gas, R.uint64, 'arg0');
            return this;
        },
        gasPrice(gp) {
            opts.gasPrice = R.test(gp, R.bigInt, 'arg0').toString().toLowerCase();
            return this;
        },
        gasPayer(addr) { console.warn("gasPayer is not supported in compat mode"); return this; },
        cache(hints) { console.warn("account.method :cache is not supported in compat mode"); return this; },
        asClause: (...args) => {
            const inputsLen = (coder.definition.inputs || []).length;
            R.ensure(inputsLen === args.length, `args count expected ${inputsLen}`);
            try {
                const data = coder.encode(...args);
                return {
                    to: acc.address,
                    value: value.toString().toLowerCase(),
                    data
                };
            }
            catch (err) {
                throw new R.BadParameter(`args can not be encoded (${err.message})`);
            }
        },
        call(...args) {
            const clause = this.asClause(...args);
            const explainer = connex.thor.explain([clause]);
            if (opts.caller)
                explainer.caller(opts.caller);
            if (opts.gas)
                explainer.gas(opts.gas);
            if (opts.gasPrice)
                explainer.gasPrice(opts.gasPrice);
            return explainer.execute().then(outputs => {
                const out = Object.assign(Object.assign({}, outputs[0]), { decoded: {} });
                if (!out.reverted && out.data !== '0x') {
                    out.decoded = coder.decode(out.data);
                }
                return out;
            });
        },
        transact(...args) {
            const clause = this.asClause(...args);
            return connex.vendor.sign('tx', [clause]);
        }
    };
};
const newEvent = (acc, jsonABI, connex) => {
    const coder = new abi.Event(JSON.parse(JSON.stringify(jsonABI)));
    const encode = (indexed) => {
        const topics = coder.encode(indexed);
        return {
            address: acc.address,
            topic0: topics[0] || undefined,
            topic1: topics[1] || undefined,
            topic2: topics[2] || undefined,
            topic3: topics[3] || undefined,
            topic4: topics[4] || undefined
        };
    };
    return {
        asCriteria: indexed => {
            try {
                return encode(indexed);
            }
            catch (err) {
                throw new R.BadParameter(`arg0: can not be encoded (${err.message})`);
            }
        },
        filter(indexed) {
            R.test(indexed, [{}], 'arg0');
            if (indexed.length === 0) {
                indexed = [{}];
            }
            const criteriaSet = indexed.map((o, i) => {
                try {
                    return encode(o);
                }
                catch (err) {
                    throw new R.BadParameter(`arg0.#${i}: can not be encoded (${err.message})`);
                }
            });
            const filter = connex.thor.filter('event', criteriaSet);
            return {
                range(r) { filter.range(r); return this; },
                order(o) { filter.order(o); return this; },
                cache() { console.warn('account.event :cache is not supported in compat mode'); return this; },
                apply(offset, limit) {
                    return filter.apply(offset, limit).then(events => events.map(e => {
                        const event = Object.assign(Object.assign({}, e), { decoded: {} });
                        event.decoded = coder.decode(event.data, event.topics);
                        return event;
                    }));
                }
            };
        }
    };
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcGF0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2NvbXBhdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsR0FBRyxFQUFFLE1BQU0sYUFBYSxDQUFBO0FBQ2pDLE9BQU8sS0FBSyxDQUFDLE1BQU0sc0NBQXNDLENBQUE7QUFFekQsbUNBQW1DO0FBQ25DLE1BQU0sVUFBVSxPQUFPLENBQUMsT0FBZ0I7SUFDcEMsTUFBTSxFQUFFLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQTtJQUN2QixNQUFNLEVBQUUsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFBO0lBQ3pCLE9BQU87UUFDSCxJQUFJLElBQUk7WUFDSixNQUFNLEVBQUUsR0FBZ0I7Z0JBQ3BCLElBQUksT0FBTyxLQUFLLE9BQU8sRUFBRSxDQUFDLE9BQU8sQ0FBQSxDQUFDLENBQUM7Z0JBQ25DLElBQUksTUFBTTtvQkFDTixNQUFNLENBQUMsR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFBO29CQUNuQix1Q0FDTyxDQUFDLEtBQ0osSUFBSSxrQ0FDRyxDQUFDLENBQUMsSUFBSSxLQUNULFFBQVEsRUFBRSxRQUFRLE9BRXpCO2dCQUNMLENBQUM7Z0JBQ0QsTUFBTSxFQUFFLEdBQUcsRUFBRTtvQkFDVCxNQUFNLENBQUMsR0FBRyxFQUFFLENBQUMsTUFBTSxFQUFFLENBQUE7b0JBQ3JCLE9BQU87d0JBQ0gsSUFBSSxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxpQ0FBTSxDQUFDLEtBQUUsUUFBUSxFQUFFLFFBQVEsSUFBRyxDQUFDO3FCQUNqRSxDQUFBO2dCQUNMLENBQUM7Z0JBQ0QsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFO29CQUNaLE1BQU0sRUFBRSxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUE7b0JBQzNCLE9BQU87d0JBQ0gsSUFBSSxP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